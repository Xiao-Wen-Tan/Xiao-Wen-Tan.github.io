<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Wen Wen web</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Wen Wen web</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<p>Assignment 1</p>
<p>https://utdallas.yul1.qualtrics.com/jfe/preview/previewId/d50fc369-437f-4b35-9926-e9023cf72267/SV_5vEij4x6nYs0JDw?Q_CHL=preview&amp;Q_SurveyVersionID=current</p>
<ol start="2" type="1">
<li><p>a. Survey structure: start with one matrix question with 12 single choice questions and 2 selection questions</p>
<p>b. basic information of movie consumption behaviour, and then about specific spending actions, ending with demographic information</p>
<p>c. the question is from more general side to more specific ones</p></li>
<li><p>Keep surveys short and relevant.</p>
<p>Ensure clarity in questions and instructions.</p>
<p>Offer incentives when possible.</p>
<p>Provide timely feedback and acknowledgments.</p>
<p>Continuously seek feedback for improvement.</p></li>
</ol>
<p>Assignment 2</p>
<p>the differences between using the Google Trends website and the <strong><code>gtrendsR</code></strong> package for data analysis:</p>
<ol type="1">
<li><p><strong>Data Retrieval</strong>:</p>
<ul>
<li><p><strong>Google Trends Website</strong>: This platform offers a user-friendly, web-based interface for manual data retrieval. Users can easily input search terms, select geographical regions, and timeframes to obtain data with a few clicks.</p></li>
<li><p><strong>gtrendsR Package</strong>: In contrast, <strong><code>gtrendsR</code></strong> is an R package that automates data retrieval from Google Trends. It allows you to programmatically fetch data, which can be particularly useful for large-scale or repetitive data collection tasks. However, it requires coding and scripting knowledge in R.</p></li>
</ul></li>
<li><p><strong>Flexibility</strong>:</p>
<ul>
<li><p><strong>Google Trends Website</strong>: While the website provides basic options for data retrieval, it may not offer advanced features or automation capabilities. Users are limited to the options provided on the website.</p></li>
<li><p><strong>gtrendsR Package</strong>: <strong><code>gtrendsR</code></strong> offers greater flexibility. It allows you to customize queries extensively using R scripts. You can automate the collection of data for multiple search terms, regions, and time periods, making it suitable for more complex data analysis tasks.</p></li>
</ul></li>
<li><p><strong>Customization</strong>:</p>
<ul>
<li><p><strong>Google Trends Website</strong>: The Google Trends website offers a standard set of features for querying and visualizing data. Customization options are often limited to selecting search terms, regions, and date ranges.</p></li>
<li><p><strong>gtrendsR Package</strong>: With <strong><code>gtrendsR</code></strong>, you have the power to create custom queries and analyses. You can control various parameters, such as the time interval for data retrieval, the number of search terms, and how data is structured and saved. This flexibility is valuable for researchers and analysts who need tailored data for specific research questions.</p></li>
</ul></li>
<li><p><strong>Ease of Use</strong>:</p>
<ul>
<li><p><strong>Google Trends Website</strong>: The website is designed to be user-friendly and accessible to individuals without programming skills. It’s suitable for beginners who want a quick and simple way to access Google Trends data.</p></li>
<li><p><strong>gtrendsR Package</strong>: Using <strong><code>gtrendsR</code></strong> requires familiarity with R programming. It may not be as accessible to beginners who are not comfortable with coding. However, for R users, it provides a powerful tool for integrating Google Trends data into their data analysis workflow.</p></li>
</ul></li>
</ol>
<p>Assignment 3</p>
<p>Wordfish is a statistical method for analyzing word frequencies in texts, often used for studying latent dimensions in text data. It’s an algorithm used for text scaling and visualization to analyze word usage patterns and relationships within a text corpus.</p>
<p>Final project</p>
<p><strong>Pancreas Medical Device Recall</strong></p>
<p>Ali Shah</p>
<p>Renjie Lu</p>
<p>Xiaowen Tan</p>
<p>Mason Womble</p>
<p>University of Texas at Dallas</p>
<p>EPPS 6302 Project</p>
<p><strong>Abstract</strong></p>
<p>This study focuses on the crucial role of the pancreas in human health, emphasizing its endocrine and exocrine functions and the management of related disorders such as diabetes and pancreatic cancer. Our findings highlight the challenges in the reliability and safety of medical devices like insulin pumps and glucose monitoring systems, often necessary for disease management. We report frequent device recalls due to technical malfunctions and emphasize the need for stringent regulatory oversight and technological advancements in device design. The study underscores the importance of comprehensive patient education in enhancing device efficacy and patient safety. In conclusion, our research advocates for a multidisciplinary approach to improve the reliability and effectiveness of pancreatic medical devices, thereby enhancing patient care and treatment outcomes.</p>
<p>Keywords: pancreas, medical device, medical device recall.&nbsp;</p>
<p><strong>Introduction</strong></p>
<p>The pancreas serves as a critical organ in the human body with dual functionalities: endocrine and exocrine. Its endocrine function is instrumental in regulating blood glucose levels through the secretion of hormones such as insulin and glucagon, playing a significant role in diabetes management (American Diabetes Association, 2021). The exocrine aspect involves producing digestive enzymes essential for nutrient breakdown and absorption (Forsmark, 2017). Consequently, pancreatic disorders like diabetes, pancreatitis, and pancreatic cancer have profound health implications, necessitating effective medical interventions (Maitra &amp; Goggins, 2020).</p>
<p>Medical devices that assist pancreatic functions, such as insulin pumps and continuous glucose monitoring systems, are pivotal in managing diabetes. Their reliability and accuracy are crucial since malfunctions can result in severe health risks like hypoglycemia or hyperglycemia (Klonoff, 2018). However, these devices have encountered issues leading to recalls due to software errors, hardware malfunctions, and inaccurate readings (Zhou et al., 2022; Smith et al., 2019).</p>
<p>The frequent recalls highlight the need for stringent regulatory oversight and thorough testing protocols (Zuckerman et al., 2011). The FDA plays a vital role in ensuring the safety and efficacy of these medical devices, with their post-market surveillance systems being crucial for monitoring device performance in real-world settings (Shuren &amp; Califf, 2016).</p>
<p>Research in this field increasingly focuses on improving the design and functionality of pancreas-related medical devices. This includes sensor technology advancements, robust insulin delivery system algorithms, and user-friendly interfaces to minimize errors (Desai &amp; Gross, 2018; Heinemann &amp; Krinelke, 2012). Comprehensive patient education and training are also essential to ensure correct device usage, significantly reducing device-related errors and improving patient outcomes (Vallis, 2016; Polonsky &amp; Hessler, 2015).</p>
<p>In summary, research on the pancreas and its related medical devices is vital for managing pancreatic diseases and advancing medical technology and patient safety. Continuous innovation, regulatory vigilance, and research are essential to enhance the reliability and efficacy of these life-sustaining devices.</p>
<p>The research into factors leading to the recall of pancreas medical devices is crucial for patient safety and healthcare quality. Medical errors, including device failures or design flaws, significantly impact patient outcomes and are a major cause of morbidity and mortality (Liebel et al., 2018). These failures can arise from various factors, such as design flaws, manufacturing errors, inadequate user training, or complications in clinical settings (Smith et al., 2019).</p>
<p>Regulatory reforms are necessary for medical device safety, including more stringent pre-market testing and robust post-market surveillance (Zuckerman et al., 2011; Shuren &amp; Califf, 2016). Most device recalls are due to issues that could have been identified with more rigorous testing, emphasizing the need for comprehensive evaluation strategies (Kesselheim et al., 2011).</p>
<p>Patient education and psychological well-being are also critical in managing chronic conditions that require complex medical devices (Vallis, 2016). Additionally, technological advancements present both opportunities and challenges in developing safer and more effective medical devices (Desai &amp; Gross, 2018; Heinemann &amp; Krinelke, 2012).</p>
<p>In conclusion, enhancing patient safety and healthcare quality in relation to pancreas medical devices necessitates a multidisciplinary approach involving regulatory oversight, technological innovation, comprehensive patient education, and ongoing surveillance.</p>
<p>Understanding the causes behind these recalls is crucial for preventing future errors and improving device reliability and efficacy, particularly for life-sustaining devices like insulin pumps and glucose monitors (Ball et al., 2018). Device reliability directly affects patient well-being, with malfunctions leading to serious health consequences and impacting patient trust in medical technologies (McAdams et al., 2018; Vallis, 2016).</p>
<p>The recall process can be disruptive for patients, underscoring the need for rigorous pre-market testing and ongoing post-market surveillance (Hauser et al., 2010; Zuckerman et al., 2011). The FDA’s role in ensuring device safety through approval processes and oversight is critical (Shuren &amp; Califf, 2016). Effective patient education and training are key to mitigating risks associated with medical devices (Polonsky &amp; Hessler, 2015).</p>
<p>In summary, addressing the factors leading to pancreas medical device recalls requires improved device design and testing, stringent regulatory oversight, effective patient education, and robust post-market surveillance. This approach is vital for enhancing patient safety, ensuring device reliability, and improving the quality of life for those dependent on medical devices.</p>
<p><strong>Methodology</strong></p>
<p>The information collected encompasses a variety of critical parameters, each contributing to the comprehensive analysis and understanding of a significant event. Among these pivotal data points are the total count of devices that have been subjected to recall. Additionally, the recall date serves as a marker, allowing a detailed examination of the events leading up to the initiation of the recall.</p>
<p>Furthermore, the identity and role of the corporate entity responsible for the recall are integral components of the data collection process. This includes an exploration of the company’s profile, standing within the industry, and any pertinent contextual information that may shed light on the motivations and circumstances surrounding the recall. Unveiling the corporate aspects contributes to a more comprehensive view with this recall initiative.</p>
<p>The distribution dynamics of the affected devices from another dimension of the data being amassed, encompassing a thorough examination of how these products have been disseminated across various markets and regions. This detailed analysis of devices’ geographical and demographic reach is instrumental in gauging the potential impact on consumers and stakeholders, thereby adding depth to the overall understanding of the recall.</p>
<p>An additional layer of complexity arises from investigating the specific issues afflicting the recalled devices. This includes but is not limited to issues such as faulty design, software anomalies, and manufacturing irregularities. The detailed examination of each issue type provides valuable insights into the intricacies of the challenges faced, allowing for a nuanced understanding of the circumstances surrounding the recall and facilitating informed decision-making in devising remedial actions.</p>
<p><strong>Data Collection</strong></p>
<p>The objective of this report is to detail the process of scraping FDA data from the official OpenFDA platform. OpenFDA, an Elasticsearch-based API, provides valuable public data about drugs, devices, and foods, including information on recalls, adverse events, and more. The primary goal of this data scraping project is to extract meaningful insights from the Device Recall dataset provided by the OpenFDA API.</p>
<p><strong>Data Source</strong></p>
<p>The data for this project is sourced from the OpenFDA API, an Elasticsearch-based platform that serves public FDA data about drugs, devices, and foods. The focus is on the Device Recall dataset. The following figure displays different breaches of data underneath the big umbrella of FDA</p>
<p><strong>Scraping Process</strong></p>
<p>The tools and technologies employed for scraping include Python for programmatically sending requests, and libraries such as BeautifulSoup and requests for data collection. The scraping process involved a combination of manual and programmatic approaches to interact with the OpenFDA API. OpenFDA provides real-time access to a wealth of information about drugs, devices, and foods, and the Device Recall dataset was the specific focus of this project.</p>
<p>API calls were manually conducted to explore the structure of the data and understand the parameters available for querying. This approach allowed for an initial exploration of the OpenFDA API using a web browser. For instance, a sample API call to the Device Recall endpoint:</p>
<p><a href="https://api.fda.gov/device/recall.json?search=product_description:%22Pancreas%22&amp;limit=5" class="uri">https://api.fda.gov/device/recall.json?search=product_description:%22Pancreas%22&amp;limit=5</a></p>
<p>In this example, the query searches for records in the Device Recall endpoint where the <strong>root_cause_description</strong> exactly matches “Device Design,” and it limits the results to the first 5 records. Returned result is displayed as following:</p>
<p>To automate the data retrieval process, programmatic API calls were implemented using Python. The <strong>requests</strong> library was employed to send HTTP requests to the OpenFDA API, and the obtained JSON responses were processed for further analysis. Here is a simplified example of a programmatic API call using Python:</p>
<p>import requests</p>
<p>url = “https://api.fda.gov/device/recall.json”</p>
<p>params = {</p>
<p>‘search’: ‘root_cause_description.exact:“Device Design”’,</p>
<p>‘limit’: 5</p>
<p>}</p>
<p>response = requests.get(url, params=params)</p>
<p>data = response.json()</p>
<p>The Python <strong>requests</strong> library is used to send a GET request to the specified API endpoint with the defined parameters. The response is then converted to a JSON format, allowing for easy manipulation and extraction of relevant information.</p>
<p><strong>Data Retrieval and Structure</strong></p>
<p>The OpenFDA API returned individual results as JSON objects, comprising two main sections:</p>
<p><strong>meta</strong>: Metadata about the query, including a disclaimer, data license link, last-updated date, and total matching records.</p>
<p><strong>results</strong>: An array of matching results, dependent on which endpoint was queried.</p>
<p>The structure of the JSON response facilitated efficient extraction and subsequent analysis of the data.The returned data, in JSON format, was cleaned and preprocessed to handle missing values and ensure compatibility for further analysis. In this part, we make our code of retrieving FDA data and format public. Future studies aim to use FDA data that could modify the code and put it to use. Please see Appendix A for reference.&nbsp;</p>
<p><strong>Data Cleaning</strong></p>
<p>Integral to the successful execution of this project revolved around the meticulous process of data cleansing, a crucial endeavor undertaken to enhance the efficiency and expediency of subsequent data analyses. The strategic emphasis on cleaning the data played a pivotal role in streamlining and optimizing the overall data sets, thus paving the way for a more rapid and insightful exploration of the information at hand. This meticulous data cleansing process not only contributed to the expeditiousness of subsequent analyses but also laid a robust foundation for the reliability and accuracy of the conclusions drawn from the data-driven insights.</p>
<p>The dataset obtained through web scraping of the FDA website serves as an illustrative example of the extensive efforts invested in collecting pertinent information for our study. The initial dataset, comprising a total of 50,054 devices, exhibited a considerable amount of noise and included numerous data points that were deemed extraneous to the focus of our analysis. To enhance the efficiency and precision of our subsequent analyses, several columns, such as additional contact info, cfres id, device class, fei number, k number, product code, registration number, regulation number, and event number, were identified as irrelevant and subsequently removed from the dataset.</p>
<p>The subsequent challenge in our data preprocessing journey involved narrowing down the dataset to specifically focus on devices related to the pancreas. This categorization was achieved by implementing a keyword-based filter on the “device description” column, targeting terms such as “pancreas,” “pancreatic,” and “Glucose.” Additionally, the inclusion of the keyword “glucose” was motivated by its association with pancreatic function. As a result of this filtering process, the dataset was refined, reducing the number of devices to a more manageable 79.</p>
<p>With this smaller, more focused sample size, the subsequent task involved coding the “recall reason” column into distinct categories. This categorization was based on the provided reasons for recall, resulting in the classification of devices into groups such as faulty design, incorrect labeling, contamination, or updated requirements. The faulty design category encompassed issues related to the manufacturing process or functionality of the device, such as obstruction of crucial veins or malfunctioning. Incorrect labeling pertained to discrepancies in the information presented on the device’s label, including errors in nomenclature or dosage information. Contamination was identified when devices were inadequately sterilized, a critical concern given the potential for these devices to be introduced into the human body. The updated requirements category emerged when changes in regulations, either due to legal mandates or company policies, necessitated the recall of certain devices.</p>
<p>Post-coding and data cleaning procedures, the resultant dataset exhibited a significantly improved level of clarity and relevance, setting the stage for more meaningful and insightful analyses in our ongoing research endeavor.</p>
<p><img src="https://lh7-us.googleusercontent.com/D6nmZH6eJSAiPI7K8JnN8MRoNcFvQMypTw09VMDxUc5aqo9r4sY8Esm5c5UvwDKim19LxZxXWWeunMyDrUHxJGbp3IR1zWwZpfVJ_fYCr7MalmYXfr4MQwlZwXveC-K4YWrUDP3lKd6Kc9kVGY0FG0U.png" class="img-fluid">The meticulous process of cleaning and organizing the dataset in the described manner has proven to be instrumental in facilitating a more streamlined and insightful analysis. By systematically addressing noise and removing irrelevant data points, we have not only enhanced the overall quality of the dataset but also set the stage for more nuanced and meaningful examinations of the information at hand.</p>
<p>This refined dataset has opened up avenues for novel insights, notably including a deeper exploration into the temporal aspects of the recall process. The improved organization of the data has enabled a more granular examination of the timeline associated with the entire recall process. Insights into the duration of various phases, from the initiation of the recall to its completion, now become readily accessible. This newfound capability to analyze the temporal dynamics of the recall process provides a valuable perspective, shedding light on efficiency, response times, and potential areas for improvement in the overall recall management procedures.</p>
<p>Furthermore, the streamlined dataset not only facilitates a more efficient analysis of the existing variables but also allows for the incorporation of additional parameters that may have been challenging to explore in the presence of noise and irrelevant data. This expanded analytical scope opens the door to uncovering deeper patterns, correlations, and trends that may contribute to a more comprehensive understanding of the factors influencing recalls and their subsequent resolution.</p>
<p>In essence, the effort invested in cleaning and organizing the data has not only optimized the dataset for current analyses but has also empowered the research process with the flexibility to derive fresh insights and explore hitherto uncharted dimensions of the recall phenomena. This exemplifies the iterative nature of data analysis, where the enhancement of data quality serves as a catalyst for continuous refinement and discovery within the research framework.</p>
<p><strong>Exploratory Analysis</strong></p>
<p>Embarking on the next phase of our analytical journey, we turned our attention to the development of visual graphics as a strategic tool to enhance our comprehension of the dataset. The initial focus centered on creating a graphic representation aimed at illustrate patterns related to firms with the highest frequency of recalls.</p>
<p>By leveraging graphical elements, such as bar charts or pie charts, we sought to visually depict the distribution of recalls among different firms. This approach not only facilitates a quick and intuitive assessment of the most recurrent contributors to recalls but also provides a visual narrative that can be instrumental in discerning trends and potential outliers.</p>
<p><img src="https://lh7-us.googleusercontent.com/fVAlzhZyvJsA5CdwZdIcddkzKqCGmPXeVhOfcI2zP2PQtMeffcl0qTptt00QHD3ourHz5PW3kb_XU04wR9mpVdTzxfSZURudnqaW-YW0P4wYbrAhFdz8vVrH2pIAr7c7RNNUPnJ0xmnwWmok4xDeaw4.png" class="img-fluid"><br>
<strong>Figure 1</strong></p>
<p>The presented graphic encapsulates a visual representation of various companies and the corresponding number of devices necessitating recall within our sample. Notably, Hobbs Medical, Inc.&nbsp;emerged as the most prominent entity in our dataset, with a substantial recall count of 20 devices. Following closely, the Boston Scientific Corporation exhibited the second-highest recall frequency, involving 13 devices. Aomori Olympus secured the third position with 10 devices requiring recall, and Covidien LP trailed as the fourth, necessitating the recall of 8 devices.</p>
<p>While these figures spotlight the companies with the highest recall rates in our sample, it is imperative to approach these statistics with a nuanced perspective. Drawing conclusions about the quality or adequacy of devices solely based on recall frequency may oversimplify the complexities inherent in the medical device industry. Various factors contribute to the recall totals of these companies, and it would be premature to assume that a higher recall rate implies inferior product quality.</p>
<p>One plausible explanation for the variation in recall totals among companies lies in their specialization. Companies like Hobbs Medical, Inc.&nbsp;and Boston Scientific Corporation may focus extensively on devices related to the pancreas, potentially resulting in a higher likelihood of recalls in this specific category. Additionally, larger companies, such as Boston Scientific Corporation, often possess more extensive resources and engage in a broader range of product development initiatives. This increased scope of experimentation may lead to a proportionally higher number of recalls compared to smaller counterparts.</p>
<p>In essence, the graphic serves as a starting point for understanding the recall landscape among different companies, prompting further exploration into the underlying factors contributing to these recall frequencies. Acknowledging the multifaceted nature of the medical device industry and the diverse strategies adopted by companies is crucial to deriving comprehensive insights from such visual representations.</p>
<p><strong>Figure 2</strong></p>
<p>In figure 2, we see a detailed listing of all the categories of problems that prompted the recall in the first place. Incorrect labeling is by a wide margin the most common reason for issuing a recall of pancreatic medical devices. Faulty design is a distant second with contamination as a close third. Manufacturing errors and updated requirements are comparatively uncommon, being encountered in our data sources much less frequently.<br>
One possible explanation for why labeling errors were so much more common may be due to a lack of rigor in an aspect of the design that may seem less important. Engineers that create such devices may either not pay as much attention to it as they do the functionality itself, or that task may be deferred to a third party who makes the error. Faulty design speaks for itself; the engineers behind it simply made an error in judgment while designing the medical device in question. Contamination is an environmental hazard in which specific devices were deemed unfit to actually be used lest they do more harm than good, not reflective of the efficacy of the device itself.<br>
Observing this data closely reveals a more nuanced understanding of why recalling a device may occur, informing the goals and direction of our study as a whole. Demanding simply for more scrutiny in the design of the devices, while not unwarranted, would not address the most common issue.</p>
<p><strong>Figure 3</strong></p>
<p>Figure 3 displays the amount of time in days it took for the FDA to procure the recalled pancreatic medical devices. 82 days is by a wide margin the most frequently occuring number, with 44 days as a relatively close second and 43 days as a distant third. All the remaining common numbers are too low to base any substantial judgements upon.</p>
<p>Knowing this, we can estimate that it usually takes approximately three months for the FDA to fully reclaim any faulty medical devices, if not sooner. While three months is fairly swift given the scale of the task, that is still plenty of time for someone to receive a faulty or contaminated device that may harm the recipient. This information is imperative for understanding the estimated risk that a medical device under recall can pose, and highlights the need for more thoroughness in the process of evaluating if a device is fit for distribution. It may also point to a need to enhance the speed at which recalled devices are reclaimed.</p>
<p><strong>Figure 4</strong></p>
<p>The above graphic is a visualization of how the recalled pancreatic medical devices are distributed on a much larger scale. As is evident, global distribution makes up a larger portion of the total distribution patterns. It is worth noting that the "national" variable specifically refers to the US only, but the "global" variable also includes the US in addition to all other nations included in our data sources, being the most likely cause for why "global" is so much larger in comparison. While this alone is not particularly noteworthy, it can provide important context for future findings and figures.<br>
<br>
<img src="https://lh7-us.googleusercontent.com/uC5vLhoNAU_vjS7SrgLgOx4NhoYnltMMY6cR6IbdoBdbUgdk91qZB5IpvH9bD0MPIZH1NAgLcTuI-uGm3LW-X3u9aX3J902yFYrx9FHFUIE3RfEWzPKBUhk_lhb8hhIWBOwywyoRVrNXYxkYcfdDGX8.png" class="img-fluid"></p>
<p><strong>Figure 5</strong></p>
<p>In figure 5 we see the sheer quantity of the products being recalled. The way the pie chart is structured details the percentage of groups in which the medical devices were recalled. In 70% of cases, the problem was detected relatively soon and only hundreds of devices were distributed before being successfully recalled. Recalls taking place when thousands and millions were distributed were much less common.<br>
The implication of this finding is that the FDA is very quick to detect any anomalies or malfunctions that occur with devices that they approved of. If they were not, then the thousands and millions of portions would be far larger, and there would be a significant number of victims due to the erroneous approval. When taking into account the findings of figure 2, this further emphasizes the general level of competence and efficiency possessed by the FDA. Knowing the quantity of device recalls allows us to gain a stronger grasp on how that affects overall health for parties that rely on pancreatic medical devices to function normally in day to day life. While the FDA catching the problem quickly 70% of the time is a credit to them, the remaining 30% is large enough to justify more rigorous evaluation methods and training to better ensure safety for a vulnerable population.</p>
<p><strong>Figure 6</strong></p>
<p>Figure 6 is a breakdown of the states and countries in which devices are distributed. The state of Connecticut is where the most devices are distributed, leading at 39%, followed by the state of Massachusetts and then Japan. All remaining states and countries dwindle significantly, making attempts to glean significant information based on them difficult. This could indicate that Connecticut, Massachusetts and Japan have higher levels of patients in need of pancreatic medical devices, meaning they may feel the effect of faulty devices more acutely than other areas.</p>
<p><strong>Reference</strong></p>
<p>American Diabetes Association. (2021). This reference discusses the role of the pancreas in regulating blood glucose levels through the secretion of hormones like insulin and glucagon, which are central to diabetes management.</p>
<p>Ball, et al.&nbsp;(2018). This reference emphasizes the importance of understanding the factors leading to the recall of pancreas medical devices to improve device reliability and efficacy.</p>
<p>Desai, S., &amp; Gross, C. P. (2018); Heinemann, L., &amp; Krinelke, L. G. (2012). These references focus on the research and advancements in the design and functionality of pancreas-related medical devices, including improvements in sensor technology and insulin delivery systems.</p>
<p>Forsmark, C. E. (2017). This reference provides information on the exocrine function of the pancreas, particularly in the production of digestive enzymes necessary for the breakdown and absorption of nutrients.</p>
<p>Hauser, R. G., et al.&nbsp;(2010). This source discusses the complexity and impact of the medical device recall process on patients, particularly those using devices for chronic conditions.</p>
<p>Kesselheim, et al.&nbsp;(2011). This study found that most device recalls were due to problems that could have been identified with more rigorous pre-market testing, highlighting the need for a comprehensive approach to device evaluation.</p>
<p>Klonoff, D. C. (2018). This reference highlights the critical importance of the reliability and efficacy of medical devices like insulin pumps and continuous glucose monitoring systems in managing diabetes and the serious health risks associated with their malfunction.</p>
<p>Liebel, et al.&nbsp;(2018). This reference underscores the critical nature of addressing medical errors, including those related to device failures or design flaws, within the healthcare system.</p>
<p>Maitra, A., &amp; Goggins, M. (2020). This source discusses the health implications of pancreatic disorders such as diabetes, pancreatitis, and pancreatic cancer, and the necessity for effective medical interventions.</p>
<p>McAdams, et al.&nbsp;(2018). This study on insulin pump failures highlights the potentially life-threatening consequences of mechanical and software malfunctions in these devices.</p>
<p>Shuren, J., &amp; Califf, R. M. (2016). This reference discusses the FDA's pivotal role in ensuring the safety and efficacy of medical devices, including their post-market surveillance systems.</p>
<p>Vallis, M. (2016); Polonsky, W. H., &amp; Hessler, D. (2015). These sources discuss the importance of comprehensive patient education and training in ensuring correct usage of medical devices, thereby improving patient outcomes.</p>
<p>Zhou, et al.&nbsp;(2022); Smith, et al.&nbsp;(2019). These studies address recalls in medical devices intended for pancreatic function assistance due to various reasons like software errors, hardware malfunctions, and inaccurate readings.</p>
<p>Zuckerman, et al.&nbsp;(2011). This source emphasizes the necessity for stringent regulatory oversight and rigorous testing protocols for medical devices, particularly those related to the pancreas.</p>
<p><strong>Appendix A</strong></p>
<p>import requests</p>
<p>import json</p>
<p>import os</p>
<p># URL of the JSON file containing links to the data files</p>
<p>json_url = “https://api.fda.gov/download.json”&nbsp; # Replace with the actual JSON URL</p>
<p># Directory where you want to save the downloaded data files</p>
<p>download_directory = “./openFDA_data”</p>
<p># Send a GET request to fetch the JSON file</p>
<p>response = requests.get(json_url)</p>
<p>json_data = json.loads(response.text)</p>
<p>keys = json_data[‘results’].keys()</p>
<p>keys</p>
<p># Importing libraries</p>
<p>import json</p>
<p>import csv</p>
<p># Loading JSON data</p>
<p>with open(‘./device-recall-0001-of-0001.json’, ‘r’) as file:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;data = json.load(file)</p>
<p># Exploring JSON data</p>
<p>len(data[‘results’])</p>
<p># Exploring JSON keys</p>
<p>json_data = data[‘results’][5]</p>
<p>json_data.keys()</p>
<p>for key in json_data.keys():</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;print(key)</p>
<p># Extracting sub-JSON data</p>
<p>sub_json_data = json_data[‘openfda’]</p>
<p>sub_json_data.keys()</p>
<p># Creating CSV files for specific keys</p>
<p>for tag in [“k_numbers”, “address_2”, “event_date_terminated”]:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;print(tag)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;csv_file = ‘./recall/’ + tag + ‘.csv’</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Open the CSV file for writing</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘w’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Write the keys (field names) as the first row</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([“ID”, tag])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Writing data to CSV files</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;for num in range(0, 50053):</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_data = data[‘results’][num]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘a’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_without_last_column = {key: value for key, value in json_data.items() if key == tag}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Write the corresponding values as the second row</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value = list(row_without_last_column.values())[0]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, value])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, ])</p>
<p># Creating CSV files for keys in the main JSON data</p>
<p>for tag in json_data.keys():</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;print(tag)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;csv_file = ‘./recall/’ + tag + ‘.csv’</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Open the CSV file for writing</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘w’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Write the keys (field names) as the first row</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([“ID”, tag])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Writing data to CSV files</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;for num in range(0, 50053):</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;json_data = data[‘results’][num]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘a’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_without_last_column = {key: value for key, value in json_data.items() if key == tag}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value = list(row_without_last_column.values())[0]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, value])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, ])</p>
<p># Creating CSV files for keys in the sub-JSON data</p>
<p>for tag in [“fei_number”, “registration_number”, “k_number”]:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;print(tag)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;csv_file = ‘./recall/’ + tag + ‘.csv’</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Open the CSV file for writing</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘w’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Write the keys (field names) as the first row</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([“ID”, tag])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;# Writing data to CSV files</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;for num in range(0, 50053):</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_json_data = data[‘results’][num][‘openfda’]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with open(csv_file, ‘a’, newline=’‘, encoding=’utf-8’) as csvfile:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a CSV writer</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer = csv.writer(csvfile)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_without_last_column = {key: value for key, value in sub_json_data.items() if key == tag}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Write the corresponding values as the second row</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value = list(row_without_last_column.values())[0]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, value])</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;csv_writer.writerow([num, ])</p>
<p># Merging CSV files into a single DataFrame</p>
<p>import pandas as pd</p>
<p>import os</p>
<p># Specify the folder where your CSV files are located</p>
<p>folder_path = ‘./recall’&nbsp; # Replace ‘path_to_folder’ with the actual folder path</p>
<p># Get a list of all CSV files in the folder</p>
<p>csv_files = [f for f in os.listdir(folder_path) if f.endswith(‘.csv’)]</p>
<p># Initialize an empty dictionary to store data from each CSV file</p>
<p>data = {}</p>
<p># Read each CSV file and store its content in the dictionary</p>
<p>for csv_file in csv_files:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;column_name = os.path.splitext(csv_file)[0]&nbsp; # Use the file name as the column name</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;file_path = os.path.join(folder_path, csv_file)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;data[column_name] = pd.read_csv(file_path)</p>
<p># Merge the data from the dictionary into a single DataFrame</p>
<p>merged_data = pd.concat(data.values(), axis=1)</p>
<p># Specify the path and filename for the merged CSV file</p>
<p>merged_csv_filename = ‘merged_data.csv’</p>
<p># Save the merged DataFrame to a CSV file</p>
<p>merged_data.to_csv(merged_csv_filename, index=False)</p>
<p>print(f’Merged data saved to {merged_csv_filename}’)</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>